@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Nav
@inject AuthenticationStateProvider AuthStateProvider
@inject Blazored.LocalStorage.ILocalStorageService LocalStorage

<div class="nav-container">
    <a href="/" class="brand" style="font-weight: 900; font-size: 1.5rem; text-decoration: none; color: black;">
        CAR_MARKET<span style="color: magenta;">_</span>
    </a>

    <div class="nav-links" style="display: flex; align-items: center;">
        <NavLink href="" Match="NavLinkMatch.All">Inventory</NavLink>

        <AuthorizeView Roles="Admin">
            <Authorized>
                <NavLink href="admin/dashboard" class="btn-nav-accent" style="background: red !important;">DASHBOARD</NavLink>
            </Authorized>
        </AuthorizeView>
        <AuthorizeView>
            <Authorized>
                <NavLink href="car/create">Add_Car</NavLink>
                <NavLink href="my-favorites">MyFavorites</NavLink>
                <NavLink href="account">Profile</NavLink>
                <button @onclick="Logout" class="btn-logout">LOGOUT</button>
            </Authorized>
            <NotAuthorized>
                <NavLink href="login">Sign_In</NavLink>
                <NavLink href="register" class="btn-nav-accent">Sign_Up</NavLink>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>

<style>
    .btn-logout {
        background: none;
        border: 2px solid black;
        font-weight: 800;
        font-size: 0.75rem;
        padding: 5px 15px;
        margin-left: 20px;
        cursor: pointer;
    }
    .btn-logout:hover { background: black; color: white; }

    .btn-nav-accent {
        background: black;
        color: white !important;
        padding: 5px 15px !important;
    }
</style>

@code {
private async Task Logout()
{
await LocalStorage.RemoveItemAsync("authToken");
((CarListingApp.Client.Auth.CustomAuthStateProvider)AuthStateProvider).NotifyUserLogout();
Nav.NavigateTo("/", forceLoad: true);
}
}