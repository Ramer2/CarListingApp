@page "/"
@using CarListingApp.Services.DTOs.Car
@inject HttpClient Http

<h1 style="font-weight:900; letter-spacing:-1px; margin-bottom:30px;">ACTIVE LISTINGS</h1>

<div class="inventory-grid">
    @if (_cars == null)
    {
        <div class="loading-box">SYNCHRONIZING_INVENTORY...</div>
    }
    else if (!_cars.Any())
    {
        <div class="loading-box">NO_VEHICLES_FOUND_IN_DATABASE.</div>
    }
    else
    {
        @foreach (var car in _cars)
        {
            <div class="heavy-card" style="margin-bottom: 15px; background: white;">
                <div style="padding: 20px; flex: 1; border-right: 2px solid black;">
                    <div style="font-size: 0.6rem; font-weight: 900; color: #888;">VEHICLE_ID: #@car.Id</div>
                    <h4 style="margin: 5px 0; font-weight: 900;">@car.Brand.ToUpper() @car.Model.ToUpper()</h4>
                    <span class="status-badge" style="background: @(car.Status == "Active" ? "#00ff00" : "magenta"); color: @(car.Status == "Active" ? "black" : "white");">
                        @car.Status.ToUpper()
                    </span>
                </div>
                <div style="width: 150px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #fafafa;">
                    <div style="font-weight: 900; font-size: 1.2rem;">$@car.Price.ToString("N0")</div>
                    <a href="/car/@car.Id" style="font-size: 0.7rem; color: black; font-weight: bold; margin-top: 10px;">VIEW_DETAILS</a>
                </div>
            </div>
        }
    }
</div>

@code {
    private List<CarDto>? _cars;

    protected override async Task OnInitializedAsync()
    {
        try {
            _cars = await Http.GetFromJsonAsync<List<CarDto>>("cars");
        } catch {
            _cars = new();
        }
    }
}